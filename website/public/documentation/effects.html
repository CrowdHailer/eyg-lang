<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://unpkg.com/tailwindcss@2.2.11/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/layout.css" />
    <link rel="stylesheet" href="/neo.css" />
    <script src="/easel.js" async defer></script>
    <title>Documentation - Eyg</title>
  </head><body ><div  class="vstack wrap"><header  class="yellow-gradient drop w-full"><div class="hstack max-w-3xl mx-auto">
          <div class="expand leading-relaxed">
            <div class="text-pink-4 border-l-8 border-white pl-2 -ml-2">
              There is no <strong class="font-bold">syntax</strong> ...
            </div>
            <ul class="underline text-black pl-2">
              <li><a href="/">Home</a></li>
              <li><a href="/documentation">Documentation</a></li>
            </ul>
          </div>
          <div class="border-2 border-black bg-purple-3 my-10 rounded-xl neo-shadow -mr-20">
            <div class="ml-5 mr-24">
              <h3 class="font-bold text-white">Eat Your Greens</h3>
              <h1 class="text-2xl font-bold">EYG</h1>
            </div>
          </div>
        </div><div  class="max-w-3xl mx-auto px-4 my-4 text-xl hstack wrap"><h1 >Effects</h1><span  class="expand"></span></div></header><div  class="expand w-full blue-gradient drop"><div class="max-w-3xl w-full mx-auto">
          <div class="wrap bg-white neo-shadow border-black border-2 mb-2 rounded-xl overflow-hidden">
            <pre data-easel="#hello" class="overflow-auto outline-none w-full my-1 mx-4" spellcheck="false" contenteditable="true"><span class="text-gray-500">let </span><span class="">message</span><span class="text-gray-500"> = </span><span class="text-green-4">"Hello, World!"</span><span class="text-gray-500">
let </span><span class="">greet</span><span class="text-gray-500"> = </span><span class="">message</span><span class="text-gray-500"> -&gt; perform </span><span class="text-yellow-4">Alert</span><span class="text-gray-500">(</span><span class="">message</span><span class="text-gray-500">)
</span><span class="">greet</span><span class="text-gray-500">(</span><span class="">message</span><span class="text-gray-500">)</span></pre>
            <div class="bg-purple-1 px-4 font-mono font-bold">:press space to run</div>
          </div>
          <!-- have a run button at the bottom which shows the file name before
          running. <br />

          Space on the right can highlight cursor and show types -->
        </div><div  class="max-w-3xl w-full mx-auto"><h2  class="mx-4">Choose</h2></div><p  class="max-w-3xl w-full mx-auto px-4 text-lg">A random choice. 
Implementations can be handled to always return a fixed value or from a list or all.

The value passed when invoking the Choose effect is unit i.e. an empty record as behaviour is not defined by the caller of choose</p><div  class="max-w-3xl w-full mx-auto"><div  class="wrap bg-white neo-shadow border-black border-2 mb-2 rounded-xl overflow-hidden" data-ready="snippet"><pre  class="overflow-auto outline-none w-full my-1 mx-4">_ -> {
  let choose = _ -> perform Choose({})
  let always = value -> handle Choose(_arg -> resume -> resume(value))
  let _ = always(True({}))(_ -> {
    let first = choose({})
    let second = choose({})
    [first, second]
  })
  let _ = "[True, True]"
  vacant
}</pre><div  class="bg-purple-1 px-4 font-mono font-bold">:</div><script  type="application/eygir">{"0":"f","l":"_","b":{"0":"l","l":"choose","v":{"0":"f","l":"_","b":{"0":"a","f":{"0":"p","l":"Choose"},"a":{"0":"u"}}},"t":{"0":"l","l":"always","v":{"0":"f","l":"value","b":{"0":"a","f":{"0":"h","l":"Choose"},"a":{"0":"f","l":"_arg","b":{"0":"f","l":"resume","b":{"0":"a","f":{"0":"v","l":"resume"},"a":{"0":"v","l":"value"}}}}}},"t":{"0":"l","l":"_","v":{"0":"a","f":{"0":"a","f":{"0":"v","l":"always"},"a":{"0":"a","f":{"0":"t","l":"True"},"a":{"0":"u"}}},"a":{"0":"f","l":"_","b":{"0":"l","l":"first","v":{"0":"a","f":{"0":"v","l":"choose"},"a":{"0":"u"}},"t":{"0":"l","l":"second","v":{"0":"a","f":{"0":"v","l":"choose"},"a":{"0":"u"}},"t":{"0":"a","f":{"0":"a","f":{"0":"c"},"a":{"0":"v","l":"first"}},"a":{"0":"a","f":{"0":"a","f":{"0":"c"},"a":{"0":"v","l":"second"}},"a":{"0":"ta"}}}}}}},"t":{"0":"l","l":"_","v":{"0":"s","v":"[True, True]"},"t":{"0":"z","c":""}}}}}}</script></div></div><p  class="max-w-3xl w-full mx-auto px-4 text-lg">choose both by resuming the exec function multiple times

Need to wrap the exec function to return a list of it's value so that it can be concatenated in the handler</p><div  class="max-w-3xl w-full mx-auto"><div  class="wrap bg-white neo-shadow border-black border-2 mb-2 rounded-xl overflow-hidden" data-ready="snippet"><pre  class="overflow-auto outline-none w-full my-1 mx-4">_ -> {
  let concat = vacant
  let choose = _ -> perform Choose({})
  let both = exec -> {
    let handler = _arg -> resume -> {
      let first = resume(True({}))
      let second = resume(False({}))
      concat(first)(second)
    }
    handle Choose(handler)(_ -> [exec({})])
  }
  let _ = both(_ -> {
    let first = choose({})
    let second = choose({})
    [first, second]
  })
  "[[True, True], [True, False], [False, True], [False, False]"
}</pre><div  class="bg-purple-1 px-4 font-mono font-bold">:</div><script  type="application/eygir">{"0":"f","l":"_","b":{"0":"l","l":"concat","v":{"0":"z","c":""},"t":{"0":"l","l":"choose","v":{"0":"f","l":"_","b":{"0":"a","f":{"0":"p","l":"Choose"},"a":{"0":"u"}}},"t":{"0":"l","l":"both","v":{"0":"f","l":"exec","b":{"0":"l","l":"handler","v":{"0":"f","l":"_arg","b":{"0":"f","l":"resume","b":{"0":"l","l":"first","v":{"0":"a","f":{"0":"v","l":"resume"},"a":{"0":"a","f":{"0":"t","l":"True"},"a":{"0":"u"}}},"t":{"0":"l","l":"second","v":{"0":"a","f":{"0":"v","l":"resume"},"a":{"0":"a","f":{"0":"t","l":"False"},"a":{"0":"u"}}},"t":{"0":"a","f":{"0":"a","f":{"0":"v","l":"concat"},"a":{"0":"v","l":"first"}},"a":{"0":"v","l":"second"}}}}}},"t":{"0":"a","f":{"0":"a","f":{"0":"h","l":"Choose"},"a":{"0":"v","l":"handler"}},"a":{"0":"f","l":"_","b":{"0":"a","f":{"0":"a","f":{"0":"c"},"a":{"0":"a","f":{"0":"v","l":"exec"},"a":{"0":"u"}}},"a":{"0":"ta"}}}}}},"t":{"0":"l","l":"_","v":{"0":"a","f":{"0":"v","l":"both"},"a":{"0":"f","l":"_","b":{"0":"l","l":"first","v":{"0":"a","f":{"0":"v","l":"choose"},"a":{"0":"u"}},"t":{"0":"l","l":"second","v":{"0":"a","f":{"0":"v","l":"choose"},"a":{"0":"u"}},"t":{"0":"a","f":{"0":"a","f":{"0":"c"},"a":{"0":"v","l":"first"}},"a":{"0":"a","f":{"0":"a","f":{"0":"c"},"a":{"0":"v","l":"second"}},"a":{"0":"ta"}}}}}}},"t":{"0":"s","v":"[[True, True], [True, False], [False, True], [False, False]"}}}}}}</script></div></div><div  class="max-w-3xl w-full mx-auto"><h2  class="mx-4">Fail</h2></div><p  class="max-w-3xl w-full mx-auto px-4 text-lg">Short circuit execution with a failure.

I'm not sure of naming here. Can I use Error for the union type i.e. in Ok | Error at the same time as it for the Effect</p><div  class="max-w-3xl w-full mx-auto"><div  class="wrap bg-white neo-shadow border-black border-2 mb-2 rounded-xl overflow-hidden" data-ready="snippet"><pre  class="overflow-auto outline-none w-full my-1 mx-4">_ -> {
  let result = {
    let ok = Ok
    let error = Error
    let fail = perform Error
    let expect = match {
      Ok value -> value
      Error reason -> fail(reason)
      vacant
    }
    let rescue = exec -> {
      let handler = reason -> _resume -> error(reason)
      handle Error(handler)(_ -> ok(exec({})))
    }
    {fail: fail, expect: expect, rescue: rescue}
  }
  vacant
}</pre><div  class="bg-purple-1 px-4 font-mono font-bold">:</div><script  type="application/eygir">{"0":"f","l":"_","b":{"0":"l","l":"result","v":{"0":"l","l":"ok","v":{"0":"t","l":"Ok"},"t":{"0":"l","l":"error","v":{"0":"t","l":"Error"},"t":{"0":"l","l":"fail","v":{"0":"p","l":"Error"},"t":{"0":"l","l":"expect","v":{"0":"a","f":{"0":"a","f":{"0":"m","l":"Ok"},"a":{"0":"f","l":"value","b":{"0":"v","l":"value"}}},"a":{"0":"a","f":{"0":"a","f":{"0":"m","l":"Error"},"a":{"0":"f","l":"reason","b":{"0":"a","f":{"0":"v","l":"fail"},"a":{"0":"v","l":"reason"}}}},"a":{"0":"z","c":""}}},"t":{"0":"l","l":"rescue","v":{"0":"f","l":"exec","b":{"0":"l","l":"handler","v":{"0":"f","l":"reason","b":{"0":"f","l":"_resume","b":{"0":"a","f":{"0":"v","l":"error"},"a":{"0":"v","l":"reason"}}}},"t":{"0":"a","f":{"0":"a","f":{"0":"h","l":"Error"},"a":{"0":"v","l":"handler"}},"a":{"0":"f","l":"_","b":{"0":"a","f":{"0":"v","l":"ok"},"a":{"0":"a","f":{"0":"v","l":"exec"},"a":{"0":"u"}}}}}}},"t":{"0":"a","f":{"0":"a","f":{"0":"e","l":"fail"},"a":{"0":"v","l":"fail"}},"a":{"0":"a","f":{"0":"a","f":{"0":"e","l":"expect"},"a":{"0":"v","l":"expect"}},"a":{"0":"a","f":{"0":"a","f":{"0":"e","l":"rescue"},"a":{"0":"v","l":"rescue"}},"a":{"0":"u"}}}}}}}}},"t":{"0":"z","c":""}}}</script></div></div><div  class="max-w-3xl w-full mx-auto"><h2  class="mx-4">Log</h2></div><p  class="max-w-3xl w-full mx-auto px-4 text-lg">Logs are an effect
</p><div  class="max-w-3xl w-full mx-auto"><div  class="wrap bg-white neo-shadow border-black border-2 mb-2 rounded-xl overflow-hidden" data-ready="snippet"><pre  class="overflow-auto outline-none w-full my-1 mx-4">{log: term -> perform Log(term), capture: {
  let handler = message -> k -> {
    let inner = k({})
    {logs: [message, ..inner.logs], ..inner}
  }
  run -> handle Log(handler)(_ -> {
    let return = run({})
    {return: return, logs: []}
  })
}}</pre><div  class="bg-purple-1 px-4 font-mono font-bold">:</div><script  type="application/eygir">{"0":"a","f":{"0":"a","f":{"0":"e","l":"log"},"a":{"0":"f","l":"term","b":{"0":"a","f":{"0":"p","l":"Log"},"a":{"0":"v","l":"term"}}}},"a":{"0":"a","f":{"0":"a","f":{"0":"e","l":"capture"},"a":{"0":"l","l":"handler","v":{"0":"f","l":"message","b":{"0":"f","l":"k","b":{"0":"l","l":"inner","v":{"0":"a","f":{"0":"v","l":"k"},"a":{"0":"u"}},"t":{"0":"a","f":{"0":"a","f":{"0":"o","l":"logs"},"a":{"0":"a","f":{"0":"a","f":{"0":"c"},"a":{"0":"v","l":"message"}},"a":{"0":"a","f":{"0":"g","l":"logs"},"a":{"0":"v","l":"inner"}}}},"a":{"0":"v","l":"inner"}}}}},"t":{"0":"f","l":"run","b":{"0":"a","f":{"0":"a","f":{"0":"h","l":"Log"},"a":{"0":"v","l":"handler"}},"a":{"0":"f","l":"_","b":{"0":"l","l":"return","v":{"0":"a","f":{"0":"v","l":"run"},"a":{"0":"u"}},"t":{"0":"a","f":{"0":"a","f":{"0":"e","l":"return"},"a":{"0":"v","l":"return"}},"a":{"0":"a","f":{"0":"a","f":{"0":"e","l":"logs"},"a":{"0":"ta"}},"a":{"0":"u"}}}}}}}}},"a":{"0":"u"}}}</script></div></div><div  class="max-w-3xl w-full mx-auto"><h2  class="mx-4">Async Await</h2></div><p  class="max-w-3xl w-full mx-auto px-4 text-lg">Both async and await are implemented as effects and can be caught for test purposes</p></div></div></body>